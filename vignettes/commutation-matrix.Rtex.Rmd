---
title: "Commutation Matrix"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Commutation Matrix}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(linearAlgebra)
```

The commutation matrix $\mathbf{K}_{m}$ is the
$\frac{m \left( m + 1 \right)}{2} \times m^2$
matrix
for a given $m \times m$ symmetric matrix $\mathbf{A}$
where
\begin{equation}
   \mathbf{K}_{m} \mathrm{vec} \left( \mathbf{A} \right)
   =
   \mathrm{vech} \left( \mathbf{A}^{\prime} \right)
\end{equation}

```{r}
x_i <- matrix(
  data = c(
    1.0, 0.5, 0.4,
    0.5, 1.0, 0.6,
    0.4, 0.6, 1.0
  ),
  ncol = 3
)
m_i <- dim(x_i)[1]
kcap(m_i)
kcap(m_i) %*% vec(x_i)

all.equal(
  c(kcap(m_i) %*% vec(x_i)), vech(t(x_i)),
  check.names = FALSE
)
```
