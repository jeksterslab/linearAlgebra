---
title: "Duplication Matrix"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Duplication Matrix}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(linearAlgebra)
```

The duplication matrix $\mathbf{D}_{m}$ is the
$m^2 \times \frac{m \left( m + 1 \right)}{2}$
matrix
for a given $m \times m$ symmetric matrix $\mathbf{A}$
where
\begin{equation}
   \mathbf{D}_{m} \mathrm{vech} \left( \mathbf{A} \right)
   =
   \mathrm{vec} \left( \mathbf{A} \right) .
\end{equation}

```{r}
x <- matrix(
  data = c(
    1.0, 0.5, 0.4,
    0.5, 1.0, 0.6,
    0.4, 0.6, 1.0
  ),
  ncol = 3
)
m <- dim(x)[1]
dcap(m)
dcap(m) %*% vech(x)

all.equal(
  c(dcap(m) %*% vech(x)),
  vec(x)
)
```
